<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>타로카드 미니게임</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: linear-gradient(to bottom, #fff1f9, #ffe6f0);
      padding: 1rem;
      text-align: center;
    }
    h1 {
      color: #cc338b;
    }
    .card-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1rem;
      margin-top: 2rem;
    }
    .popup-entry-wrapper {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1rem;
    }
    .popup-entry {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 120px;
    }
    .popup-card-text {
      font-size: 0.85rem;
      margin-top: 0.5rem;
      text-align: center;
      background: rgba(255,255,255,0.7);
      padding: 0.3rem 0.5rem;
      border-radius: 8px;
      color: #444;
    }
    .result-card {
      width: 100px;
      height: 150px;
      background-color: white;
      border: 2px solid #ff99cc;
      border-radius: 16px;
      box-shadow: 0 0 12px rgba(255, 153, 204, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 0.95rem;
      cursor: pointer;
      flex-basis: calc(20% - 1rem);
    }
    .summary-text {
      margin-top: 2rem;
      background: rgba(255,255,255,0.8);
      border-radius: 12px;
      padding: 1rem;
      color: #333;
      font-weight: bold;
      font-size: 0.9rem;
      text-align: center;
    }
    #overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 999;
    }
    #popup {
      background: white;
      border-radius: 16px;
      padding: 2rem;
      width: 90%;
      max-width: 600px;
      box-shadow: 0 0 16px rgba(0,0,0,0.3);
    }
    button {
      margin-top: 2rem;
      padding: 0.8rem 1.2rem;
      background: #ff99cc;
      border: none;
      border-radius: 8px;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>🔮 3장 타로카드 미니게임 🔮</h1>
  <div id="card-container" class="card-container"></div>
  <button onclick="resetGame()">다시 뽑기</button>

  <div id="overlay">
    <div id="popup">
      <h2>🔮 당신의 타로 결과</h2>
      <div id="popup-content"></div>
      <button onclick="closePopup()">닫기</button>
    </div>
  </div>

  <script>
    const tarotDeck = [
      "The Fool", "The Magician", "The High Priestess", "The Empress", "The Emperor",
      "The Hierophant", "The Lovers", "The Chariot", "Strength", "The Hermit",
      "Wheel of Fortune", "Justice", "The Hanged Man", "Death", "Temperance",
      "The Devil", "The Tower", "The Star", "The Moon", "The Sun",
      "Judgement", "The World"
    ];

const contextualInterpretations = {
  "The Fool_과거": "큐빅 시절, 명호를 처음 보고 우주가 열린 듯한 충격을 받았던 때예요.",
  "The Fool_현재": "지금은 입덕 부정기를 지나 명호의 눈빛 하나에도 마음이 출렁이는 시기예요.",
  "The Fool_미래": "명호와의 인연은 예기치 못한 방향으로 당신을 행복하게 만들 거예요.",
  "The Magician_과거": "명호가 한 무대에서 영감을 받아 팬아트나 글로 감정을 쏟아냈던 기억이 있어요.",
  "The Magician_현재": "지금은 명호 덕분에 일상에서도 창의력이 샘솟는 느낌이에요.",
  "The Magician_미래": "명호를 통해 자신만의 팬활동 세계관이 더 깊어질 거예요.",
  "The High Priestess_과거": "명호에게 입덕하기 전 처음에는 쉽게 다가가지 못했던 순간이 있었어요.",
  "The High Priestess_현재": "지금은 말 없이도 명호의 진심을 느끼며 묵묵히 팬심을 키워가는 시기예요.",
  "The High Priestess_미래": "명호의 사소한 한 마디가 내 마음을 가장 잘 알아주는 위로가 되어줄 거예요.",
  "The Empress_과거": "명호가 위버스에 올려준 다정한 말 한 마디가 하루를 버티게 해줬던 기억이 있어요.",
  "The Empress_현재": "지금은 명호의 존재만으로도 삶의 작은 순간들이 더 따뜻하게 느껴져요.",
  "The Empress_미래": "명호는 앞으로도 당신에게 애정 어린 응원과 위로를 줄 존재일 거예요.",
  "The Emperor_과거": "힘들었던 날, 명호의 무대나 인터뷰가 마음을 단단히 붙잡아줬던 적이 있어요.",
  "The Emperor_현재": "지금은 명호가 삶을 대하는 태도나 철학에서 나도 단단해지는 법을 배우는 중이에요.",
  "The Emperor_미래": "앞으로 나는 작은 새가 되어 큰 나무처럼 흔들림 없는 명호 곁에 남을 거예요.",
  "The Hierophant_과거": "명호의 말에서 새로운 가치관의 시작점이 되었던 순간이 있었어요.",
  "The Hierophant_현재": "지금은 명호를 통해 내가 어떤 사람이고 싶은지를 자주 되새겨보게 돼요.",
  "The Hierophant_미래": "명호의 진심 어린 조언과 말들이 삶의 지침이 될 거예요.",
  "The Lovers_과거": "명호에게 빠졌던 입덕 초기에 모든 것이 반짝이던 순간이 또렷이 떠올라요.",
  "The Lovers_현재": "지금은 명호를 좋아하는 마음이 일상의 중심이 된 시기예요.",
  "The Lovers_미래": "앞으로 당신은 명호 덕분에 나 자신을 더 사랑하게 될 거예요.",
  "The Chariot_과거": "명호의 컴백을 쫓아다니며 계획표를 짜고 움직였던 때가 있었어요.",
  "The Chariot_현재": "지금은 어떤 일정도 두렵지 않을 만큼 명호를 향한 마음이 확고해요.",
  "The Chariot_미래": "앞으로 명호를 향한 응원이 당신에게도 자부심이 될 거예요.",
  "Strength_과거": "명호를 좋아한 이후 감정을 오래 품으며 천천히 마음을 다잡았던 기억이 있어요.",
  "Strength_현재": "지금은 큰 표현보다는 조용히 명호를 지켜보며 힘을 얻는 시기예요.",
  "Strength_미래": "당신의 꾸준한 응원이 명호에게도 따뜻한 에너지로 전해질 거예요.",
  "The Hermit_과거": "명호를 조용히 지켜보며 마음속으로 혼자만의 팬 활동을 즐기던 시절이 있었어요.",
  "The Hermit_현재": "지금은 혼자서도 조용히 명호의 콘텐츠를 챙기며 나만의 애정을 쌓는 중이에요.",
  "The Hermit_미래": "앞으로도 명호를 향한 당신만의 속깊은 응원이 계속될 거예요.",
  "Wheel of Fortune_과거": "우연히 본 영상 하나로 명호에게 입덕해버렸던 그 찰나가 기억나요.",
  "Wheel of Fortune_현재": "지금은 매 순간이 명호 덕분에 예상치 못한 행복으로 가득해요.",
  "Wheel of Fortune_미래": "앞으로 명호와의 인연이 또 다른 우연과 기쁨을 데려올 거예요.",
  "Justice_과거": "팬으로서 명호를 지지하면서 내 선택이 옳았다고 느꼈던 순간이 있었어요.",
  "Justice_현재": "지금은 명호를 바라보며 나의 가치와 기준을 더 분명히 세워가는 중이에요.",
  "Justice_미래": "앞으로도 명호와 함께한 시간들이 내 선택의 확신이 되어줄 거예요.",
  "The Hanged Man_과거": "명호의 활동을 기다리며 잠시 멈춰 있었던 시간이 있었어요.",
  "The Hanged Man_현재": "지금은 명호의 말이나 행동을 천천히 곱씹으며 의미를 되새기는 시기예요.",
  "The Hanged Man_미래": "앞으로는 인내가 필요한 순간에도 명호가 당신의 위안이 되어줄 거예요.",
  "Death_과거": "명호의 공백기나 변화 속에서 아쉬움을 느끼며 적응해갔던 시절이 있어요.",
  "Death_현재": "지금은 명호를 향한 감정이 새로운 형태로 자리 잡는 시기예요.",
  "Death_미래": "앞으로 명호와의 관계도 새롭게 다시 시작될 수 있을 거예요.",
  "Temperance_과거": "덕질과 일상 사이에서 균형을 맞추려 노력했던 시절이 있어요.",
  "Temperance_현재": "지금은 명호를 좋아하는 감정을 무리하지 않고 잘 조율하고 있어요.",
  "Temperance_미래": "앞으로 명호와의 시간은 조화로운 방식으로 당신의 일상에 녹아들 거예요.",
  "The Devil_과거": "명호에게 너무 빠져서 다른 걸 놓쳤던 기억이 떠오르네요.",
  "The Devil_현재": "지금은 명호를 향한 집착과 사랑 사이에서 균형을 고민 중이에요.",
  "The Devil_미래": "앞으로도 명호를 향한 마음을 스스로 건강하게 조절하는 게 중요해요.",
  "The Tower_과거": "명호의 갑작스런 소식에 멘붕을 겪었던 순간이 있었어요.",
  "The Tower_현재": "지금은 명호의 변화에 놀라기도 하지만 그 안에서 본질을 보려 해요.",
  "The Tower_미래": "앞으로 예상치 못한 일들이 있어도 명호와의 신뢰는 더 단단해질 거예요.",
  "The Star_과거": "명호의 웃음이나 말 한마디에 큰 위로를 받았던 기억이 있어요.",
  "The Star_현재": "지금은 명호가 나에게 희망과 치유의 상징이 되고 있어요.",
  "The Star_미래": "앞으로 명호는 당신의 어두운 날에도 빛이 되어줄 거예요.",
  "The Moon_과거": "명호를 좋아하면서 감정의 혼란이나 오해로 방황했던 시절이 있었어요.",
  "The Moon_현재": "지금은 명호에 대한 감정이 복잡하지만 점점 내 중심을 찾아가고 있어요.",
  "The Moon_미래": "앞으로도 감정의 기복은 있겠지만 명호와의 신뢰가 길을 밝혀줄 거예요.",
  "The Sun_과거": "명호 덕분에 모든 게 반짝이던 시절이 있었어요.",
  "The Sun_현재": "지금은 명호의 존재만으로도 매일이 감사하고 행복해요.",
  "The Sun_미래": "앞으로 당신은 명호와의 추억이 가장 소중한 빛으로 남을 거예요.",
  "Judgement_과거": "명호를 향한 감정을 솔직하게 돌아봤던 계기가 있었어요.",
  "Judgement_현재": "지금은 명호를 좋아하는 내 모습에 대해 자부심을 느끼는 시기예요.",
  "Judgement_미래": "앞으로 당신은 명호 덕분에 더 단단하고 성숙한 팬이 될 거예요.",
  "The World_과거": "명호와 함께한 이벤트나 팬콘이 완벽했던 마무리로 기억돼요.",
  "The World_현재": "지금은 명호와의 인연이 하나의 사이클을 이루며 안정감을 줘요.",
  "The World_미래": "앞으로 명호와의 관계는 새로운 시작과 더 큰 완성으로 이어질 거예요."
};

    const basicMeanings = {
      "The Fool": "새로운 시작, 자유로운 에너지",
      "The Magician": "의지와 창조력, 자원 활용",
      "The High Priestess": "직관, 내면의 지혜",
      "The Empress": "풍요, 사랑, 창조성",
      "The Emperor": "권위, 안정, 책임",
      "The Hierophant": "전통, 조언, 영적 가르침",
      "The Lovers": "사랑, 선택, 관계의 조화",
      "The Chariot": "전진, 의지력, 승리",
      "Strength": "용기, 인내, 부드러운 힘",
      "The Hermit": "고독, 성찰, 내면의 길",
      "Wheel of Fortune": "운명의 변화, 기회",
      "Justice": "공정, 균형, 책임",
      "The Hanged Man": "희생, 관점 변화",
      "Death": "끝, 변화, 새로운 시작",
      "Temperance": "조화, 절제, 균형",
      "The Devil": "속박, 유혹",
      "The Tower": "파괴, 충격, 재정비",
      "The Star": "희망, 영감, 회복",
      "The Moon": "혼란, 직감, 감정의 깊이",
      "The Sun": "성공, 기쁨, 명확성",
      "Judgement": "자각, 부활, 평가",
      "The World": "완성, 성취"
    };

    let selectedCards = [];

    function renderCards() {
      const container = document.getElementById("card-container");
      container.innerHTML = "";
      selectedCards = [];
      document.getElementById("overlay").style.display = "none";
      const shuffled = [...tarotDeck].sort(() => 0.5 - Math.random());
      shuffled.forEach(card => {
        const div = document.createElement("div");
        div.className = "result-card";
        div.textContent = "?";
        div.onclick = () => selectCard(div, card);
        container.appendChild(div);
      });
    }

    function selectCard(div, cardName) {
      if (selectedCards.length >= 3 || div.classList.contains("revealed")) return;
      div.classList.add("revealed");
      div.textContent = cardName;
      selectedCards.push(cardName);
      if (selectedCards.length === 3) showPopup();
    }

    function showPopup() {
      const positions = ["과거", "현재", "미래"];
      const contentDiv = document.getElementById("popup-content");
      contentDiv.innerHTML = "";

      const wrapper = document.createElement("div");
      wrapper.className = "popup-entry-wrapper";

      selectedCards.forEach((card, index) => {
        const pos = positions[index];
        const contextualKey = `${card}_${pos}`;
        const meaning = contextualInterpretations[contextualKey] || basicMeanings[card];

        const entry = document.createElement("div");
        entry.className = "popup-entry";

        const cardBox = document.createElement("div");
        cardBox.className = "result-card";
        cardBox.textContent = card;
        cardBox.onclick = () => saveCardAsImage(cardBox);

        const text = document.createElement("p");
        text.className = "popup-card-text";
        text.innerHTML = `<strong>${pos}</strong><br>(${card})<br>${meaning}`;

        entry.appendChild(cardBox);
        entry.appendChild(text);
        wrapper.appendChild(entry);
      });

      contentDiv.appendChild(wrapper);

      const summary = document.createElement("div");
      summary.className = "summary-text";
      summary.textContent = generateSummary(selectedCards);
      contentDiv.appendChild(summary);

      document.getElementById("overlay").style.display = "flex";
    }

    function generateSummary(cards) {
      return `${cards.join(", ")}는 당신이 원하는 바를 이뤄줄 수 있는 등불이 될거에요.`;
    }

    function resetGame() {
      renderCards();
    }

    function closePopup() {
      document.getElementById("overlay").style.display = "none";
    }

    function saveCardAsImage(element) {
      html2canvas(element).then(canvas => {
        const link = document.createElement("a");
        link.download = "tarot-card.png";
        link.href = canvas.toDataURL();
        link.click();
      });
    }

    renderCards();
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</body>
</html>
